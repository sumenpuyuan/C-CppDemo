# 一、设计内容： #
1、开发一个职工工资管理程序，实现对职工的工资管理。职工的信息包括工号、姓名、岗位工资、薪级工资、职务津贴、工会费、保险费、水电费、应发工资、实发工资等信息，其中应发工资和实发工资在前面六项数值的基础上求得：
应发工资=岗位工资+薪级工资+职务津贴
实发工资=应发工资-工会费-保险费-水电费
具体实现的管理功能如下：
（1） 输入并显示多个职工的信息。

（2） 对职工的信息可以按照工号、姓名进行查询。

（3） 按照工号可对职工的信息进行删除，删除前需要进一步确认。

（4） 计算职工的实发工资。

（5） 按照工号可对职工信息进行修改，修改前先显示该职工的全部信息，然后询问是否确认修改，最后根据确认信息“Y”或“是”进行修改，否则不修改；

（6） 按照应发工资对职工信息进行排序。

程序所显示的菜单内容如下：
职工工资管理系统：

1 创建

2 添加

3 查询

4 删除

5 修改

6 汇总实发工资

7 显示

8 退出

请选择：
二、程序要求
请选择：
二、程序要求

1、 用C语言实现系统；

2、 利用数组或结构体实现上述题目的数据结构设计；

3、 系统具有增加、查询、修改、删除、排序等基本功能；


4、 系统各部分功能的使用采用菜单选择形式；

5、 系统的各个功能模块要求用函数的形式实现；

6、 完成设计任务并书写课程设计报告，最后提交C源程序和课程设计报告。

注：

1）显示或输出可根据需要显式输出（即选择菜单中的输出或显示）或隐式输出（完成某项操作后即刻输出）；

2）如果同学认为自己有特殊想法也可编程实现。或者同学自己有想要做的题目，提出来经指导教师同意后亦可替换题目。
# 三 设计分析 #
（一） 程序的主函数和菜单函数

程序的最开始定义一个数据结构体和一个链表的结构体。
因为程序要处理的数据比较多，所以在主函数里加入了调整窗口大小的函数。增加显示时间功能，使界面更加友好。定义一个全局变量worker，为其分配内存。这个变量将联系贯穿所有的函数. 程序的菜单函数使用while（1）死循环，让菜单一直显现。用switch函数判断用户输入序号.

（二）添加职工信息函数

定义两个指针*p,*r。给p动态分配内存，用户输入数据。自动计算应发工资，实发工资。连接链表进入保存文件函数。进入后先用fopen函数判断文件是否可以打开。成功打开后用fprintf格式化输出函数输出到文件。提示文件保存成功。之后询问用户是否继续添加职工。

（三） 查询职工信息


先用if（！p）判断链表是否为空。不为空进入二级菜单，按工号查询和按姓名查询。都用p遍历所有信息，用strcmp函数比较或直接比较找，找到后调用shownoly函数展示员工信息。

（四） 删除职工函数

定义三个指针变量，首先还是判
断链表是否为空，不为空后。调用showall（）函数展示所有职工后要求用户输入要删除的工号，用p遍历所有信息，strcmp函数比较，找到后调shownoly函数展示用户信息，询问用户是否确认删除，确认删除。让r指向p的前一个节点，让s=r->pnext;
//s保存p这各节点
r->pnext=r->pnext->pnext;跳过p这个节点，达到删除的目的。Free（s），释放无用内存。提示用户删除成功。

（五）修改职工信息

首先依旧是判断链表是否为空，不为空后。输入要修改的工号，strcmp函数比较，p遍历所有工号，找到后展示用户信息，询问用户是否确认修改，确认修改后让用户输入数据，覆盖之前的数据即可。修改完后展示修改完的用户信息。

（六） 浏览所有职工信息

首先还是判断链表是否为空，不为空后，p遍历所有信息，输出数据即可。

（七） 载入文件中的职工信息

定义两个指针变量p，q。文件指针fp。首先判断打开文件是否成功。。While（！feof（fp）），给q动态分配内存，用fscanf格式输入函数打到内存里

（八） 退出函数


打印“感谢您的使用，下次再见！”调用sleep休眠函数三秒后自动退出。

# 二调试与测试 #

做这个程序确实花了不少时间，遇到了很多棘手的问题。但经过自己不断的调试和测试还是解决了，还有F10真的很重要，哈哈。

让我一个一个函数来回忆自己遇到的问题和自己的调试过程吧！

（一）首先是主函数，一开始窗口太小，数据老是不能正常显示，所以调整大了窗口。

（二）在添加职工信息时遇到了问题，是保存文件的问题。

①最开始我把提示用户是否保存文件放到了当用户按0返回主菜单时，这样就不能更加灵活保存用户信息，所以每添加一个用户后直接询问用户是否保存用户信息，更加灵活。

②在进行两次保存后会出现重复的职工信息，仔细观察代码，是在保存时直接从worker第一个节点开始保存，所以新增一个指针变量来让他指向最后一个有用的节点，进行保存。

③打开文件形式的变更，一开始使用wb形式打开文件这样如果该文件存在，保存时会清除文件的所有信息，不尽人意，我希望如果该文件不存在则建立该文件，存在则往后追加信息，一开始的想法是先判断文件第一个字符是否为空即EOF，后来看到书上关于a形式的说明，以添加的形式打开一个文本文件，在尾部追加数据，若文件不存在则创建新文件，果断就是a形式。

（三）载入文件函数遇到的问题

①载入文件函数与保存文件出现不匹配问题，当我用保存函数保存数据，再次打开程序重新载入时，会出现好多乱码，调试后发现，原来保存数据每次前一个职工的最后一个信息会和后一个职工的第一个信息连在一起，载入文件就出现了问题，于是在保存和载入文件各加了一个空格，完美解决。
# 
# 四设计心得与总结 #
 #

能做出来自己的程序真的很有成就感，当你敲完代码程序就可以完成指定的任务心里总会有一种喜悦。这次的课程设计，让我把学过的知识都串了起来，让我对他们有更深的理解，同时为了实现特定的功能如：载入文件。我仔细去看了书本，让我学习了新的知识点。

还有纵观我的程序核心程序其实占得比重不大，用来处理用户输入，来使程序更有好的代码占了很大的比重。还有一些比较隐形的东西，是对自己程序的不断测试才能发现的，像自己保存文件和载入文件的不协调。就是自己测试时发现的。与周围同学的交流也让我看到了自己程序欠缺的地方。

一些小的东西让我注意的是要注意自己的敲代码习惯，在做保存文件时，程序老是提示打开文件失败，看了两天代码还是没有看出来个所以然，我都快崩溃了。还是在一个偶然的时刻我在if语句后面看到了分号，我看到那个分号我自己都笑了，这种错误实在太不应该了。


总之，这次课程设计让我体会到了痛苦与快乐并存的感觉，当自己最终把他做成功时，心中的那种成就感是只有努力后才能体会的，这次课程设计让我对c语言有了更深的理解，尤其是链表和文件两部分（就这两部分老是出错），还有对于创建一个用户友好强的程序有了更多的经验。